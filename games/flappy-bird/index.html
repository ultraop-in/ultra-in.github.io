<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Flappy Bird Clone</title>
  <link rel="stylesheet" href="../../style.css"> <!-- Link to main style.css -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* Game-specific styles */
    :root {
      --bg: #0d0f1a;
      --fg: #e8ecf1;
      --accent: #6c5ce7;
      --accent-2: #00cec9;
      --danger: #ff4757;
      --pipe: #39d353;
    }
    html, body {
      height: 100%;
      margin: 0;
      background: radial-gradient(1200px 600px at 60% -10%, rgba(108,92,231,.15), transparent 60%),
                  radial-gradient(1000px 500px at 20% -20%, rgba(0,206,201,.12), transparent 55%),
                  var(--bg);
      color: var(--fg);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      overflow-x: hidden; /* Prevent horizontal scroll */
    }
    .game-page-container {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
    }
    .game-content-wrapper {
        flex-grow: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 20px;
        padding-top: 100px; /* Account for fixed navbar */
    }
    .game-header {
        text-align: center;
        margin-bottom: 30px;
    }
    .game-header h1 {
        font-size: 2.5rem;
        color: var(--light-color);
        margin-bottom: 10px;
    }
    .game-thumbnail {
        width: 100%;
        max-width: 560px;
        border-radius: 16px;
        box-shadow: 0 10px 40px rgba(0,0,0,.35);
        margin-bottom: 30px;
    }
    .game-info-card {
        background: rgba(13,15,26,.85);
        border: 1px solid rgba(255,255,255,.08);
        border-radius: 16px;
        padding: 25px;
        text-align: center;
        width: min(92vw, 560px);
        box-shadow: 0 10px 30px rgba(0,0,0,.45);
        margin-bottom: 30px;
    }
    .game-info-card h2 {
        font-size: 1.8rem;
        color: var(--primary-color);
        margin-bottom: 15px;
    }
    .game-info-card p {
        font-size: 1rem;
        color: var(--gray-color);
        margin-bottom: 10px;
        line-height: 1.6;
    }
    .game-info-card ul {
        list-style: none;
        padding: 0;
        text-align: left;
        margin-top: 20px;
    }
    .game-info-card ul li {
        color: var(--light-color);
        margin-bottom: 8px;
        padding-left: 20px;
        position: relative;
    }
    .game-info-card ul li::before {
        content: 'â€¢';
        color: var(--primary-color);
        position: absolute;
        left: 0;
    }
    .game-play-btn {
        background: var(--accent);
        color: white;
        font-weight: 700;
        padding: 12px 30px;
        border-radius: 999px;
        cursor: pointer;
        box-shadow: 0 8px 24px rgba(108,92,231,.4);
        transition: transform .15s ease, filter .15s ease;
        font-size: 1.1rem;
        border: none;
        margin-top: 20px;
        text-decoration: none; /* For anchor tag styling */
        display: inline-block;
    }
    .game-play-btn:hover {
        transform: translateY(-2px);
        filter: brightness(1.05);
    }

    /* Existing game styles, adjusted for new structure */
    .wrap {
      position: fixed; inset: 0;
      display: grid; place-items: center;
      gap: 14px;
      background: radial-gradient(1200px 600px at 60% -10%, rgba(108,92,231,.15), transparent 60%),
                  radial-gradient(1000px 500px at 20% -20%, rgba(0,206,201,.12), transparent 55%),
                  var(--bg);
      z-index: 100; /* Ensure it's above other content when active */
      display: none; /* Hidden by default */
    }
    canvas {
      background: linear-gradient(#66b3ff, #87d8ff 30%, #bdf) no-repeat;
      box-shadow: 0 10px 40px rgba(0,0,0,.35);
      border-radius: 16px;
      image-rendering: pixelated;
      max-width: min(95vw, 560px);
      max-height: 85vh;
      width: 100%;
      height: auto;
    }
    .hud {
      position: absolute; inset: 0; pointer-events: none; display: grid; place-items: start center;
      padding-top: 10px; font-weight: 700; text-shadow: 0 2px 10px rgba(0,0,0,.35);
      font-variant-numeric: tabular-nums;
    }
    .score { font-size: clamp(24px, 5vw, 44px); letter-spacing: .03em; }
    .controls { position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); opacity: .9; font-size: 12px; }
    .panel {
      position: absolute; inset: 0; display: grid; place-items: center; gap: 18px; background: radial-gradient(60% 60% at 50% 40%, rgba(13,15,26,.35), rgba(13,15,26,.65));
    }
    .card {
      pointer-events: auto; background: rgba(13,15,26,.85); border: 1px solid rgba(255,255,255,.08); border-radius: 16px; padding: 18px 20px; text-align: center; width: min(92vw, 420px); box-shadow: 0 10px 30px rgba(0,0,0,.45);
    }
    .card h1 { margin: 0 0 6px; font-size: clamp(22px, 4.5vw, 28px); }
    .muted { opacity: .75; font-size: 13px; }
    .btns { display: flex; gap: 10px; justify-content: center; margin-top: 12px; }
    button {
      appearance: none; border: 0; background: var(--accent); color: white; font-weight: 700; padding: 10px 16px; border-radius: 999px; cursor: pointer; box-shadow: 0 8px 24px rgba(108,92,231,.4); transition: transform .15s ease, filter .15s ease; font-size: 14px;
    }
    button:hover { transform: translateY(-1px); filter: brightness(1.05); }
    button.secondary { background: transparent; color: var(--fg); border: 1px solid rgba(255,255,255,.18); box-shadow: none; }
    .rightTop { position:absolute; top:10px; right:12px; display:flex; gap:8px; pointer-events:auto; }
    .chip { padding: 6px 10px; border-radius: 999px; border: 1px solid rgba(255,255,255,.12); background: rgba(13,15,26,.55); font-size: 12px; }
    a { color: var(--accent-2); text-decoration: none; }

    /* Responsive adjustments */
    @media (max-width: 768px) {
        .game-header h1 {
            font-size: 2rem;
        }
        .game-info-card h2 {
            font-size: 1.5rem;
        }
        .game-play-btn {
            padding: 10px 25px;
            font-size: 1rem;
        }
    }
  </style>
</head>
<body>
  <!-- Navigation -->
  <nav id="navbar">
    <div class="container">
        <div class="logo">
            <a href="../../index.html">Ultra<span class="highlight">OP</span></a>
        </div>
        <ul>
            <li><a href="../../index.html#about">About</a></li>
            <li><a href="../../index.html#channels">Channels</a></li>
            <li><a href="../../index.html#gaming" class="active">Games</a></li>
            <li><a href="../../blog.html">Blog</a></li>
            <li><a href="../../index.html#achievements">Stats</a></li>
            <li><a href="../../index.html#support">Support</a></li>
            <li><a href="../../index.html#contact">Contact</a></li>
        </ul>
        <div class="mobile-menu">
            <i class="fas fa-bars"></i>
        </div>
    </div>
  </nav>

  <div class="game-page-container">
    <div class="game-content-wrapper" id="game-landing-page">
        <div class="game-header">
            <h1>Flappy Bird Clone</h1>
        </div>
        <img src="../../images/flappy-bird-thumbnail.jpg" alt="Flappy Bird Thumbnail" class="game-thumbnail">
        <div class="game-info-card">
            <h2>About the Game</h2>
            <p>Flappy Bird is a mobile game where the player controls a bird, attempting to fly between columns of green pipes without hitting them. The game is notoriously difficult and addictive!</p>
            <a href="#" class="game-play-btn" id="start-game-btn">Play Flappy Bird</a>
            <h2>How to Play</h2>
            <ul>
                <li>Tap/Click/Space to make the bird flap its wings and fly upward.</li>
                <li>Release to let gravity pull the bird down.</li>
                <li>Navigate through the gaps between the pipes.</li>
                <li>Each pair of pipes you pass through earns you one point.</li>
                <li>Colliding with any pipe or the ground ends the game.</li>
                <li>Press 'P' during gameplay to pause the game.</li>
                <li>Your best score is saved locally in your browser.</li>
            </ul>
        </div>
    </div>

    <!-- Game Container (hidden by default) -->
    <div class="wrap" id="game-wrap">
      <canvas id="game" width="360" height="640" aria-label="Flappy Bird Clone"></canvas>

      <div class="hud">
        <div class="score" id="score">0</div>
        <div class="controls">Tap / Click / Space to flap â€¢ P to pause</div>
      </div>

      <div class="rightTop">
        <span class="chip">Best: <span id="best">0</span></span>
        <button class="secondary" id="muteBtn" title="Toggle sound">ðŸ”Š</button>
      </div>

      <div class="panel" id="panel">
        <!-- Content dynamically loaded by JS -->
      </div>
    </div>
  </div>

  <footer>
      <!-- Same footer as index.html -->
      <div class="container">
          <div class="footer-content">
              <div class="footer-logo">
                  <span>Ultra<span class="highlight">OP</span></span>
                  <p>Gaming Beyond Limits</p>
              </div>
              <div class="footer-links">
                  <h3>Quick Links</h3>
                  <ul>
                      <li><a href="../../index.html#about">About</a></li>
                      <li><a href="../../index.html#channels">Channels</a></li>
                      <li><a href="../../index.html#support">Support</a></li>
                      <li><a href="../../index.html#contact">Contact</a></li>
                  </ul>
              </div>
              <div class="footer-social">
                  <h3>Connect</h3>
                  <div class="social-links">
                      <a href="https://instagram.com/ultraopp" target="_blank"><i class="fab fa-instagram"></i></a>
                      <a href="https://discord.gg/ZQ2afmPvuP" target="_blank"><i class="fab fa-discord"></i></a>
                      <a href="https://www.whatsapp.com/channel/0029VaeMLDaHgZWfuPDefa0t" target="_blank"><i class="fab fa-whatsapp"></i></a>
                      <a href="https://www.rooter.gg/profile/142404154" target="_blank"><i class="fas fa-gamepad"></i></a>
                  </div>
              </div>
          </div>
          <div class="footer-bottom">
              <p>&copy; 2025 UltraOP. All Rights Reserved.</p>
          </div>
      </div>
  </footer>

  <script>
    // --- Utilities ---
    const clamp = (n, a, b) => Math.max(a, Math.min(b, n));
    const rand = (a, b) => Math.random() * (b - a) + a;

    // --- Canvas & scaling ---
    const cvs = document.getElementById('game');
    const ctx = cvs.getContext('2d');
    const W = cvs.width, H = cvs.height;

    // --- Game state ---
    const State = { READY: 0, RUN: 1, PAUSE: 2, OVER: 3 };
    let state = State.READY;

    let score = 0;
    let best = +localStorage.getItem('flappy_best') || 0;
    const scoreEl = document.getElementById('score');
    const bestEl  = document.getElementById('best');
    bestEl.textContent = best;

    // --- Bird ---
    const bird = {
      x: 90,
      y: H * 0.45,
      r: 14,
      vy: 0,
      gravity: 980, // px/s^2
      flap: -300,   // px/s impulse
      rot: 0
    };

    // --- Pipes ---
    const pipes = [];
    const pipeCfg = { w: 56, gap: 125, speed: 120, spawnEvery: 1400, ground: 72 };
    let lastSpawn = 0;

    // --- Ground (simple strip) ---
    const groundY = H - pipeCfg.ground;

    // --- Timing ---
    let last = 0; // ms
    let rafId = null;

    // --- Audio (minimal, no external files) ---
    const AudioSys = (() => {
      const ctx = new (window.AudioContext || window.webkitAudioContext)();
      let muted = false;
      function beep(type = 'sine', freq = 880, dur = 0.08, vol = 0.2) {
        if (muted) return;
        const o = ctx.createOscillator();
        const g = ctx.createGain();
        o.type = type; o.frequency.value = freq; g.gain.value = vol;
        o.connect(g); g.connect(ctx.destination);
        o.start();
        o.stop(ctx.currentTime + dur);
      }
      return {
        beep,
        set muted(v){ muted = v; },
        get muted(){ return muted; }
      };
    })();

    // DOM elements for game UI
    const gameLandingPage = document.getElementById('game-landing-page');
    const gameWrap = document.getElementById('game-wrap');
    const startGameBtn = document.getElementById('start-game-btn');
    const panel = document.getElementById('panel');
    const muteBtn = document.getElementById('muteBtn');

    // Event listener for starting the game from the landing page
    startGameBtn.addEventListener('click', () => {
        gameLandingPage.style.display = 'none'; // Hide landing page
        gameWrap.style.display = 'grid'; // Show game canvas and UI
        startGame();
    });

    muteBtn.addEventListener('click', () => {
      AudioSys.muted = !AudioSys.muted;
      muteBtn.textContent = AudioSys.muted ? 'ðŸ”‡' : 'ðŸ”Š';
    });

    function startGame(){
      // reset
      score = 0; scoreEl.textContent = '0';
      pipes.length = 0;
      bird.y = H * 0.45; bird.vy = 0; bird.rot = 0;
      lastSpawn = 0; last = 0;
      state = State.RUN;
      hidePanel();
      cancelAnimationFrame(rafId);
      rafId = requestAnimationFrame(loop);
    }

    function gameOver(){
      state = State.OVER;
      best = Math.max(best, score); localStorage.setItem('flappy_best', best); bestEl.textContent = best;
      showPanel(`<h1>Game Over</h1><div class="muted">Score: <b>${score}</b> â€¢ Best: <b>${best}</b></div>
                 <div class="btns"><button id="retryBtn">Retry</button><button class="secondary" id="menuBtn">Main Menu</button></div>`);
      document.getElementById('retryBtn').onclick = startGame;
      document.getElementById('menuBtn').onclick = () => {
        state = State.READY;
        gameWrap.style.display = 'none'; // Hide game
        gameLandingPage.style.display = 'flex'; // Show landing page
        hidePanel(); // Ensure panel is hidden
      };
    }

    function showPanel(inner){ panel.style.display = 'grid'; panel.innerHTML = `<div class="card">${inner}</div>`; }
    function hidePanel(){ panel.style.display = 'none'; }

    // --- Input ---
    const flap = () => {
      if (state === State.RUN){ bird.vy = bird.flap; AudioSys.beep('sine', 700, .06, .15); }
      else if (state === State.READY){ startGame(); }
      else if (state === State.OVER){ startGame(); }
    };

    addEventListener('keydown', e => {
      if (e.code === 'Space') { e.preventDefault(); flap(); }
      if (e.code === 'KeyP') {
        if (state === State.RUN){ state = State.PAUSE; showPanel('<h1>Paused</h1><div class="btns"><button id="resume">Resume</button><button class="secondary" id="quit">Quit Game</button></div>');
          document.getElementById('resume').onclick = () => { state = State.RUN; hidePanel(); rafId = requestAnimationFrame(loop); };
          document.getElementById('quit').onclick = () => {
            state = State.READY;
            gameWrap.style.display = 'none'; // Hide game
            gameLandingPage.style.display = 'flex'; // Show landing page
            hidePanel(); // Ensure panel is hidden
          };
        } else if (state === State.PAUSE) { state = State.RUN; hidePanel(); rafId = requestAnimationFrame(loop); }
      }
    });

    ['pointerdown','touchstart'].forEach(ev => addEventListener(ev, (e) => {
      // allow UI clicks
      const t = e.target; if (t.closest && t.closest('.card')) return;
      flap();
    }, { passive: false }));

    // --- Game Loop ---
    function loop(ts){
      if (state !== State.RUN) return; // paused or over
      const dt = last ? (ts - last) / 1000 : 0; last = ts;
      update(dt);
      draw();
      rafId = requestAnimationFrame(loop);
    }

    function update(dt){
      // spawn pipes
      lastSpawn += dt * 1000;
      if (lastSpawn > pipeCfg.spawnEvery){
        lastSpawn = 0;
        const margin = 52;
        const gapY = rand(margin, groundY - margin - pipeCfg.gap);
        pipes.push({ x: W + pipeCfg.w, y: gapY, passed: false });
      }

      // move pipes
      for (let i = pipes.length - 1; i >= 0; i--){
        const p = pipes[i];
        p.x -= pipeCfg.speed * dt;
        if (p.x + pipeCfg.w < 0) pipes.splice(i, 1);
        // score when fully passed
        if (!p.passed && p.x + pipeCfg.w < bird.x - bird.r){
          p.passed = true; score++; scoreEl.textContent = String(score); AudioSys.beep('triangle', 980, .05, .18);
        }
      }

      // bird physics
      bird.vy += bird.gravity * dt;
      bird.y += bird.vy * dt;
      bird.y = clamp(bird.y, bird.r, groundY - bird.r);
      bird.rot = clamp((bird.vy / 400), -0.5, 1.0);

      // collisions
      if (bird.y >= groundY - bird.r - 0.5){ // ground hit
        AudioSys.beep('sawtooth', 160, .2, .2);
        return gameOver();
      }
      for (const p of pipes){
        // top pipe rect: (p.x, 0, w, p.y)
        // bottom pipe rect: (p.x, p.y + pipeCfg.gap, w, groundY - (p.y+pipeCfg.gap))
        if (circleRectCollide(bird.x, bird.y, bird.r, p.x, 0, pipeCfg.w, p.y) ||
            circleRectCollide(bird.x, bird.y, bird.r, p.x, p.y + pipeCfg.gap, pipeCfg.w, groundY - (p.y + pipeCfg.gap))){
          AudioSys.beep('sawtooth', 160, .2, .2);
          return gameOver();
        }
      }
    }

    function circleRectCollide(cx, cy, cr, rx, ry, rw, rh){
      const nearestX = clamp(cx, rx, rx + rw);
      const nearestY = clamp(cy, ry, ry + rh);
      const dx = cx - nearestX, dy = cy - nearestY;
      return (dx*dx + dy*dy) < cr*cr;
    }

    // --- Rendering ---
    function draw(){
      // clear sky
      ctx.clearRect(0,0,W,H);

      // parallax clouds (simple)
      ctx.save();
      ctx.globalAlpha = 0.35;
      const t = (performance.now() / 1000);
      for (let i=0;i<6;i++){
        const x = (W - ((t*15 + i*80) % (W+120))) - 60;
        const y = 70 + (i%3)*22;
        drawCloud(x, y, 24 + (i%3)*4);
      }
      ctx.restore();

      // pipes
      for (const p of pipes){
        ctx.fillStyle = '#2ecc71';
        ctx.strokeStyle = 'rgba(0,0,0,.25)';
        ctx.lineWidth = 2;
        // top
        ctx.fillRect(p.x, 0, pipeCfg.w, p.y);
        ctx.strokeRect(p.x+.5, .5, pipeCfg.w-1, p.y-1);
        // cap
        ctx.fillRect(p.x-4, p.y-18, pipeCfg.w+8, 18);
        // bottom
        const by = p.y + pipeCfg.gap;
        ctx.fillRect(p.x, by, pipeCfg.w, groundY - by);
        ctx.strokeRect(p.x+.5, by+.5, pipeCfg.w-1, groundY - by -1);
        // cap
        ctx.fillRect(p.x-4, by, pipeCfg.w+8, 18);
      }

      // ground
      ctx.fillStyle = '#8bc34a';
      ctx.fillRect(0, groundY, W, H - groundY);
      // ground stripes
      ctx.fillStyle = '#6aa134';
      for (let i=0;i<W;i+=22){ ctx.fillRect(i, groundY, 14, 8); }

      // bird
      drawBird();
    }

    function drawBird(){
      ctx.save();
      ctx.translate(bird.x, bird.y);
      ctx.rotate(bird.rot);
      // body
      ctx.fillStyle = '#ffdd57';
      ctx.beginPath(); ctx.arc(0,0,bird.r,0,Math.PI*2); ctx.fill();
      // eye
      ctx.fillStyle = '#fff'; ctx.beginPath(); ctx.arc(4,-4,4,0,Math.PI*2); ctx.fill();
      ctx.fillStyle = '#111'; ctx.beginPath(); ctx.arc(5,-4,2,0,Math.PI*2); ctx.fill();
      // beak
      ctx.fillStyle = '#ff9f43'; ctx.beginPath(); ctx.moveTo(bird.r-2,0); ctx.lineTo(bird.r+8,4); ctx.lineTo(bird.r+8,-4); ctx.closePath(); ctx.fill();
      // wing (flap)
      const flapY = Math.sin(performance.now()/100) * 2;
      ctx.fillStyle = '#f4c531'; ctx.beginPath(); ctx.ellipse(-2, 2+flapY, 8, 6, .2, 0, Math.PI*2); ctx.fill();
      ctx.restore();
    }

    function drawCloud(x, y, s){
      ctx.fillStyle = 'rgba(255,255,255,.8)';
      ctx.beginPath();
      ctx.arc(x, y, s, 0, Math.PI*2);
      ctx.arc(x+s*0.8, y-6, s*0.8, 0, Math.PI*2);
      ctx.arc(x+s*1.5, y, s*0.9, 0, Math.PI*2);
      ctx.fill();
    }

    // Mobile menu toggle (copied from main script.js)
    document.addEventListener('DOMContentLoaded', function() {
        const mobileMenuBtn = document.querySelector('.mobile-menu');
        const navMenu = document.querySelector('#navbar ul');

        mobileMenuBtn.addEventListener('click', function() {
            navMenu.classList.toggle('show');
        });

        document.querySelectorAll('#navbar ul li a').forEach(link => {
            link.addEventListener('click', () => {
                navMenu.classList.remove('show');
            });
        });
    });
  </script>
</body>
</html>
