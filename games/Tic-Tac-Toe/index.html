<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tic Tac Toe</title>
  <link rel="stylesheet" href="../../style.css"> <!-- Link to main style.css -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* Game-specific styles for Tic Tac Toe */
    :root {
      --bg: #0d0f1a;
      --fg: #e8ecf1;
      --accent: #6c5ce7;
      --accent-2: #00cec9;
      --danger: #ff4757;
      --player-x: #ff4757; /* Red for X */
      --player-o: #00cec9; /* Cyan for O */
      --win-line: #ffdd57; /* Yellow for win line */
    }
    html, body {
      height: 100%;
      margin: 0;
      background: radial-gradient(1200px 600px at 60% -10%, rgba(108,92,231,.15), transparent 60%),
                  radial-gradient(1000px 500px at 20% -20%, rgba(0,206,201,.12), transparent 55%),
                  var(--bg);
      color: var(--fg);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      overflow-x: hidden; /* Prevent horizontal scroll */
    }
    .game-page-container {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
        position: relative;
    }
    .game-content-wrapper {
        flex-grow: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 20px;
        padding-top: 100px; /* Account for fixed navbar */
        min-height: calc(100vh - 200px); /* Ensure minimum height for proper centering */
    }
    .game-header {
        text-align: center;
        margin-bottom: 30px;
    }
    .game-header h1 {
        font-size: 2.5rem;
        color: var(--light-color);
        margin-bottom: 10px;
    }
    .game-thumbnail {
        width: 100%;
        max-width: 560px;
        border-radius: 16px;
        box-shadow: 0 10px 40px rgba(0,0,0,.35);
        margin-bottom: 30px;
    }
    .game-info-card {
        background: rgba(13,15,26,.85);
        border: 1px solid rgba(255,255,255,.08);
        border-radius: 16px;
        padding: 25px;
        text-align: center;
        width: min(92vw, 560px);
        box-shadow: 0 10px 30px rgba(0,0,0,.45);
        margin-bottom: 30px;
    }
    .game-info-card h2 {
        font-size: 1.8rem;
        color: var(--primary-color);
        margin-bottom: 15px;
    }
    .game-info-card p {
        font-size: 1rem;
        color: var(--gray-color);
        margin-bottom: 10px;
        line-height: 1.6;
    }
    .game-info-card ul {
        list-style: none;
        padding: 0;
        text-align: left;
        margin-top: 20px;
    }
    .game-info-card ul li {
        color: var(--light-color);
        margin-bottom: 8px;
        padding-left: 20px;
        position: relative;
    }
    .game-info-card ul li::before {
        content: '•';
        color: var(--primary-color);
        position: absolute;
        left: 0;
    }
    .game-play-btn {
        background: var(--accent);
        color: white;
        font-weight: 700;
        padding: 12px 30px;
        border-radius: 999px;
        cursor: pointer;
        box-shadow: 0 8px 24px rgba(108,92,231,.4);
        transition: transform .15s ease, filter .15s ease;
        font-size: 1.1rem;
        border: none;
        margin-top: 20px;
        text-decoration: none; /* For anchor tag styling */
        display: inline-block;
    }
    .game-play-btn:hover {
        transform: translateY(-2px);
        filter: brightness(1.05);
    }

    /* New: Play Mode Selection Panel */
    .play-mode-panel {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(13,15,26,.95);
        border: 1px solid rgba(255,255,255,.08);
        border-radius: 16px;
        padding: 30px;
        text-align: center;
        width: min(92vw, 400px);
        box-shadow: 0 10px 40px rgba(0,0,0,.6);
        display: none; /* Hidden by default */
        flex-direction: column;
        gap: 20px;
        z-index: 1000;
    }
    .play-mode-panel::before {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        z-index: -1;
    }
    .play-mode-panel h2 {
        font-size: 1.8rem;
        color: var(--primary-color);
        margin-bottom: 10px;
    }
    .play-mode-panel .btns {
        display: flex;
        flex-direction: column;
        gap: 15px;
        margin-top: 15px;
    }
    .play-mode-panel button {
        width: 100%;
        padding: 15px;
        font-size: 1.2rem;
    }

    /* Tic Tac Toe specific styles - Full Page Game */
    .tictactoe-game-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 20px;
        width: 100%;
        min-height: 100vh;
        padding: 20px;
        padding-top: 100px; /* Account for fixed navbar */
        box-sizing: border-box;
        /* Hidden by default, shown when game starts */
        display: none;
    }

    .game-status {
        font-size: 1.8rem;
        font-weight: 700;
        color: var(--fg);
        text-align: center;
        min-height: 40px; /* Prevent layout shift */
        margin-bottom: 20px;
    }

    .game-board {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        grid-template-rows: repeat(3, 1fr);
        width: min(90vw, 400px);
        height: min(90vw, 400px);
        max-width: 400px;
        max-height: 400px;
        background-color: rgba(255,255,255,0.1);
        border-radius: 10px;
        overflow: hidden; /* For border-radius on cells */
        box-shadow: 0 10px 40px rgba(0,0,0,.35);
        position: relative; /* For win line */
        margin-bottom: 20px;
    }

    .cell {
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 4em;
        font-weight: 700;
        cursor: pointer;
        border: 2px solid rgba(255,255,255,0.2);
        box-sizing: border-box; /* Include padding and border in the element's total width and height */
        transition: background-color 0.2s ease;
    }

    .cell:hover {
        background-color: rgba(255,255,255,0.05);
    }

    .cell.x {
        color: var(--player-x);
    }

    .cell.o {
        color: var(--player-o);
    }

    .cell.win {
        background-color: rgba(255,255,255,0.15);
    }

    .reset-btn {
        background: var(--accent-2);
        color: white;
        font-weight: 700;
        padding: 12px 30px;
        border-radius: 999px;
        cursor: pointer;
        box-shadow: 0 8px 24px rgba(0,206,201,.4);
        transition: transform .15s ease, filter .15s ease;
        font-size: 1.1rem;
        border: none;
        margin-top: 10px;
    }
    .reset-btn:hover {
        transform: translateY(-2px);
        filter: brightness(1.05);
    }

    /* Win line overlay */
    .win-line {
        position: absolute;
        background-color: var(--win-line);
        z-index: 10;
        transition: all 0.3s ease-out;
    }

    /* Horizontal lines */
    .win-line.row-0 { top: 16.66%; left: 5%; width: 90%; height: 8px; transform: translateY(-50%); }
    .win-line.row-1 { top: 50%; left: 5%; width: 90%; height: 8px; transform: translateY(-50%); }
    .win-line.row-2 { top: 83.33%; left: 5%; width: 90%; height: 8px; transform: translateY(-50%); }

    /* Vertical lines */
    .win-line.col-0 { left: 16.66%; top: 5%; height: 90%; width: 8px; transform: translateX(-50%); }
    .win-line.col-1 { left: 50%; top: 5%; height: 90%; width: 8px; transform: translateX(-50%); }
    .win-line.col-2 { left: 83.33%; top: 5%; height: 90%; width: 8px; transform: translateX(-50%); }

    /* Diagonal lines */
    .win-line.diag-0 { /* Top-left to bottom-right */
        top: 5%; left: 5%; width: 90%; height: 8px;
        transform: rotate(45deg);
        transform-origin: top left;
    }
    .win-line.diag-1 { /* Top-right to bottom-left */
        top: 5%; right: 5%; width: 90%; height: 8px;
        transform: rotate(-45deg);
        transform-origin: top right;
    }

    /* Button container for game actions */
    .game-actions {
        display: flex;
        gap: 15px;
        flex-wrap: wrap;
        justify-content: center;
        margin-top: 20px;
    }
    .game-actions button {
        min-width: 150px;
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
        .game-header h1 {
            font-size: 2rem;
        }
        .game-info-card h2 {
            font-size: 1.5rem;
        }
        .game-play-btn {
            padding: 10px 25px;
            font-size: 1rem;
        }
        .cell {
            font-size: 3em;
        }
        .play-mode-panel {
            padding: 20px;
            width: min(95vw, 350px);
        }
        .game-board {
            width: min(95vw, 350px);
            height: min(95vw, 350px);
            max-width: 350px;
            max-height: 350px;
        }
        .game-actions {
            flex-direction: column;
            align-items: center;
        }
        .game-actions button {
            min-width: 200px;
        }
    }

    @media (max-width: 480px) {
        .cell {
            font-size: 2.5em;
        }
        .game-board {
            width: min(98vw, 300px);
            height: min(98vw, 300px);
            max-width: 300px;
            max-height: 300px;
        }
        .play-mode-panel {
            width: min(98vw, 300px);
            padding: 15px;
        }
        .tictactoe-game-container {
            padding-top: 80px;
        }
    }
  </style>
</head>
<body>
  <!-- Navigation -->
  <nav id="navbar">
    <div class="container">
        <div class="logo">
            <a href="../../index.html">Ultra<span class="highlight">OP</span></a>
        </div>
        <ul>
            <li><a href="../../index.html#about">About</a></li>
            <li><a href="../../index.html#channels">Channels</a></li>
            <li><a href="../../index.html#gaming" class="active">Games</a></li>
            <li><a href="../../blog.html">Blog</a></li>
            <li><a href="../../index.html#achievements">Stats</a></li>
            <li><a href="../../index.html#support">Support</a></li>
            <li><a href="../../index.html#contact">Contact</a></li>
        </ul>
        <div class="mobile-menu">
            <i class="fas fa-bars"></i>
        </div>
    </div>
  </nav>

  <div class="game-page-container">
    <!-- Landing Page -->
    <div class="game-content-wrapper" id="game-landing-page">
        <div class="game-header">
            <h1>Tic Tac Toe</h1>
        </div>
        <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/0cbe186b-687c-4d24-aff9-d747d959110f.png" alt="Modern Tic Tac Toe game board with X and O symbols in neon colors on dark background" class="game-thumbnail">
        <div class="game-info-card">
            <h2>About Tic Tac Toe</h2>
            <p>Tic Tac Toe (also known as Noughts and Crosses or Xs and Os) is a classic paper-and-pencil game for two players, X and O, who take turns marking the spaces in a 3×3 grid. The player who succeeds in placing three of their marks in a horizontal, vertical, or diagonal row wins the game.</p>
            <a href="#" class="game-play-btn" id="start-game-btn">Play Tic Tac Toe</a>
            <h2>How to Play</h2>
            <ul>
                <li>Click on any empty cell to place your mark (X or O).</li>
                <li>Player X goes first.</li>
                <li>The game ends when one player gets three of their marks in a row, or when all nine squares are filled.</li>
                <li>Click "Reset Game" to start a new round.</li>
                <li>Choose between Player vs Player or Player vs Computer modes.</li>
            </ul>
        </div>
    </div>

    <!-- Play Mode Selection Panel (Modal Popup) -->
    <div class="play-mode-panel" id="play-mode-panel">
        <h2>Choose Play Mode</h2>
        <div class="btns">
            <button class="game-play-btn" id="pvp-mode-btn">Player vs. Player</button>
            <button class="game-play-btn" id="pvc-mode-btn">Player vs. Computer</button>
        </div>
        <button class="reset-btn" id="mode-back-btn">Back to Main Menu</button>
    </div>

    <!-- Game Container (Full Page) -->
    <div class="tictactoe-game-container" id="tictactoe-game-wrap">
        <div class="game-status" id="game-status"></div>
        <div class="game-board" id="game-board">
            <div class="cell" data-cell-index="0"></div>
            <div class="cell" data-cell-index="1"></div>
            <div class="cell" data-cell-index="2"></div>
            <div class="cell" data-cell-index="3"></div>
            <div class="cell" data-cell-index="4"></div>
            <div class="cell" data-cell-index="5"></div>
            <div class="cell" data-cell-index="6"></div>
            <div class="cell" data-cell-index="7"></div>
            <div class="cell" data-cell-index="8"></div>
        </div>
        <div class="game-actions">
            <button class="reset-btn" id="reset-btn">Reset Game</button>
            <button class="game-play-btn" id="main-menu-btn">Main Menu</button>
        </div>
    </div>
  </div>

  <footer>
      <!-- Same footer as index.html -->
      <div class="container">
          <div class="footer-content">
              <div class="footer-logo">
                  <span>Ultra<span class="highlight">OP</span></span>
                  <p>Gaming Beyond Limits</p>
              </div>
              <div class="footer-links">
                  <h3>Quick Links</h3>
                  <ul>
                      <li><a href="../../index.html#about">About</a></li>
                      <li><a href="../../index.html#channels">Channels</a></li>
                      <li><a href="../../index.html#support">Support</a></li>
                      <li><a href="../../index.html#contact">Contact</a></li>
                  </ul>
              </div>
              <div class="footer-social">
                  <h3>Connect</h3>
                  <div class="social-links">
                      <a href="https://instagram.com/ultraopp" target="_blank"><i class="fab fa-instagram"></i></a>
                      <a href="https://discord.gg/ZQ2afmPvuP" target="_blank"><i class="fab fa-discord"></i></a>
                      <a href="https://www.whatsapp.com/channel/0029VaeMLDaHgZWfuPDefa0t" target="_blank"><i class="fab fa-whatsapp"></i></a>
                      <a href="https://www.rooter.gg/profile/142404154" target="_blank"><i class="fas fa-gamepad"></i></a>
                  </div>
              </div>
          </div>
          <div class="footer-bottom">
              <p>© 2025 UltraOP. All Rights Reserved.</p>
          </div>
      </div>
  </footer>

  <script>
    // DOM Elements
    const gameLandingPage = document.getElementById('game-landing-page');
    const playModePanel = document.getElementById('play-mode-panel');
    const tictactoeGameWrap = document.getElementById('tictactoe-game-wrap');

    const startGameBtn = document.getElementById('start-game-btn');
    const pvpModeBtn = document.getElementById('pvp-mode-btn');
    const pvcModeBtn = document.getElementById('pvc-mode-btn');
    const modeBackBtn = document.getElementById('mode-back-btn');
    const mainMenuBtn = document.getElementById('main-menu-btn');

    const gameStatus = document.getElementById('game-status');
    const gameBoard = document.getElementById('game-board');
    const resetButton = document.getElementById('reset-btn');
    const cells = document.querySelectorAll('.cell');

    // Game State Variables
    let board = ['', '', '', '', '', '', '', '', ''];
    let currentPlayer = 'X'; // X always starts
    let gameActive = true;
    let gameMode = ''; // 'PvP' or 'PvC'
    let winLineElement = null;

    const WINNING_COMBINATIONS = [
        [0, 1, 2, 'row-0'],
        [3, 4, 5, 'row-1'],
        [6, 7, 8, 'row-2'],
        [0, 3, 6, 'col-0'],
        [1, 4, 7, 'col-1'],
        [2, 5, 8, 'col-2'],
        [0, 4, 8, 'diag-0'],
        [2, 4, 6, 'diag-1']
    ];

    // --- UI Navigation Functions ---
    function showLandingPage() {
        gameLandingPage.style.display = 'flex';
        playModePanel.style.display = 'none';
        tictactoeGameWrap.style.display = 'none';
    }

    function showPlayModePanel() {
        gameLandingPage.style.display = 'flex'; // Keep landing page visible as background
        playModePanel.style.display = 'flex'; // Show modal over it
        tictactoeGameWrap.style.display = 'none';
    }

    function showGame() {
        gameLandingPage.style.display = 'none'; // Hide landing page completely
        playModePanel.style.display = 'none'; // Hide mode panel
        tictactoeGameWrap.style.display = 'flex'; // Show game page (full screen)
    }

    // --- Game Logic Functions ---
    function startGame(mode) {
        gameMode = mode;
        resetGame(); // Reset board and state
        showGame(); // Show the game board (full page)
        if (gameMode === 'PvC' && currentPlayer === 'O') { // If computer is O and starts (unlikely, but for robustness)
            setTimeout(computerMove, 500); // Give a slight delay for better UX
        }
    }

    function handleCellClick(event) {
        const clickedCell = event.target;
        const clickedCellIndex = parseInt(clickedCell.dataset.cellIndex);

        if (board[clickedCellIndex] !== '' || !gameActive) {
            return;
        }

        // Player's move
        makeMove(clickedCellIndex, currentPlayer);
        checkResult();

        // If PvC mode and game is still active and it's computer's turn
        if (gameActive && gameMode === 'PvC' && currentPlayer === 'O') {
            setTimeout(computerMove, 700); // Delay computer move for better UX
        }
    }

    function makeMove(index, player) {
        board[index] = player;
        cells[index].textContent = player;
        cells[index].classList.add(player.toLowerCase());
    }

    function checkResult() {
        let roundWon = false;
        for (let i = 0; i < WINNING_COMBINATIONS.length; i++) {
            const winCondition = WINNING_COMBINATIONS[i];
            let a = board[winCondition[0]];
            let b = board[winCondition[1]];
            let c = board[winCondition[2]];

            if (a === '' || b === '' || c === '') {
                continue;
            }
            if (a === b && b === c) {
                roundWon = true;
                displayWin(winCondition);
                break;
            }
        }

        if (roundWon) {
            if (gameMode === 'PvC') {
                gameStatus.textContent = currentPlayer === 'X' ? 'You Win!' : 'Computer Wins!';
            } else {
                gameStatus.textContent = `Player ${currentPlayer} Wins!`;
            }
            gameActive = false;
            return;
        }

        let roundDraw = !board.includes('');
        if (roundDraw) {
            gameStatus.textContent = 'Game Draw!';
            gameActive = false;
            return;
        }

        changePlayer();
    }

    function changePlayer() {
        currentPlayer = currentPlayer === 'X' ? 'O' : 'X';
        if (gameMode === 'PvC') {
            gameStatus.textContent = currentPlayer === 'X' ? 'Your Turn' : 'Computer\'s Turn';
        } else {
            gameStatus.textContent = `Player ${currentPlayer}'s Turn`;
        }
    }

    function displayWin(winCondition) {
        gameActive = false;
        const [idx1, idx2, idx3, lineClass] = winCondition;

        cells[idx1].classList.add('win');
        cells[idx2].classList.add('win');
        cells[idx3].classList.add('win');

        winLineElement = document.createElement('div');
        winLineElement.classList.add('win-line', lineClass);
        gameBoard.appendChild(winLineElement);
    }

    function resetGame() {
        board = ['', '', '', '', '', '', '', '', ''];
        currentPlayer = 'X';
        gameActive = true;
        if (gameMode === 'PvC') {
            gameStatus.textContent = 'Your Turn';
        } else {
            gameStatus.textContent = `Player ${currentPlayer}'s Turn`;
        }

        cells.forEach(cell => {
            cell.textContent = '';
            cell.classList.remove('x', 'o', 'win');
        });

        if (winLineElement) {
            winLineElement.remove();
            winLineElement = null;
        }
    }

    // --- Computer AI Logic (for 'O') ---
    function computerMove() {
        if (!gameActive) return;

        let bestMove = -1;
        let availableMoves = [];
        for (let i = 0; i < board.length; i++) {
            if (board[i] === '') {
                availableMoves.push(i);
            }
        }

        // 1. Check if computer can win
        for (let i = 0; i < availableMoves.length; i++) {
            const move = availableMoves[i];
            board[move] = 'O';
            if (checkWin('O')) {
                bestMove = move;
                board[move] = ''; // Undo move
                break;
            }
            board[move] = ''; // Undo move
        }

        // 2. Check if player can win and block them
        if (bestMove === -1) {
            for (let i = 0; i < availableMoves.length; i++) {
                const move = availableMoves[i];
                board[move] = 'X';
                if (checkWin('X')) {
                    bestMove = move;
                    board[move] = ''; // Undo move
                    break;
                }
                board[move] = ''; // Undo move
            }
        }

        // 3. Take center if available
        if (bestMove === -1 && board[4] === '') {
            bestMove = 4;
        }

        // 4. Take opposite corner if player took a corner
        if (bestMove === -1) {
            if (board[0] === 'X' && board[8] === '') bestMove = 8;
            else if (board[2] === 'X' && board[6] === '') bestMove = 6;
            else if (board[6] === 'X' && board[2] === '') bestMove = 2;
            else if (board[8] === 'X' && board[0] === '') bestMove = 0;
        }

        // 5. Take any available corner
        if (bestMove === -1) {
            const corners = [0, 2, 6, 8];
            for (let i = 0; i < corners.length; i++) {
                const corner = corners[i];
                if (board[corner] === '') {
                    bestMove = corner;
                    break;
                }
            }
        }

        // 6. Take any available side
        if (bestMove === -1) {
            const sides = [1, 3, 5, 7];
            for (let i = 0; i < sides.length; i++) {
                const side = sides[i];
                if (board[side] === '') {
                    bestMove = side;
                    break;
                }
            }
        }

        if (bestMove !== -1) {
            makeMove(bestMove, 'O');
            checkResult();
        }
    }

    // Helper function for AI to check win without changing game state
    function checkWin(player) {
        for (let i = 0; i < WINNING_COMBINATIONS.length; i++) {
            const winCondition = WINNING_COMBINATIONS[i];
            let a = board[winCondition[0]];
            let b = board[winCondition[1]];
            let c = board[winCondition[2]];

            if (a === player && b === player && c === player) {
                return true;
            }
        }
        return false;
    }

    // --- Event Listeners ---
    startGameBtn.addEventListener('click', showPlayModePanel);
    pvpModeBtn.addEventListener('click', () => startGame('PvP'));
    pvcModeBtn.addEventListener('click', () => startGame('PvC'));
    modeBackBtn.addEventListener('click', showLandingPage);
    mainMenuBtn.addEventListener('click', showLandingPage);

    cells.forEach(cell => cell.addEventListener('click', handleCellClick));
    resetButton.addEventListener('click', resetGame);

    // Mobile menu toggle (copied from main script.js)
    document.addEventListener('DOMContentLoaded', function() {
        const mobileMenuBtn = document.querySelector('.mobile-menu');
        const navMenu = document.querySelector('#navbar ul');

        if (mobileMenuBtn && navMenu) {
            mobileMenuBtn.addEventListener('click', function() {
                navMenu.classList.toggle('show');
            });

            document.querySelectorAll('#navbar ul li a').forEach(link => {
                link.addEventListener('click', () => {
                    navMenu.classList.remove('show');
                });
            });
        }
    });
  </script>
</body>
</html>

